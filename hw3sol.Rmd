---
title: "Solutions"
output: github_document
date: "2024-10-05"
---
```{R}
library(readxl)
library(tidyverse)
library(ggplot2)
```

```{R}
#Q2
covar= read_csv("nhanes_covar.csv", skip = 4) |>
  janitor::clean_names() |>
  mutate(age = as.integer(age)) |>
  mutate(sex = case_when(
    sex == 1 ~ "male",
    sex == 2 ~ "female"
  )) |>
  mutate(education = case_when(
    education == 1 ~ "<HS",
    education == 2 ~ "=HS",
    education == 3 ~ ">HS"
  )) |>
  filter(age>20) |>
  drop_na(sex, age)
covar
sex_edu_covar = covar |>
  group_by(sex, education) |>
  summarize(total = n())
sex_edu_covar
ggplot(covar, aes(x = age, fill = sex)) +
  geom_histogram(binwidth = 5, position = "dodge") +
  facet_wrap(~ education) +
  labs(title = "Age Distribution by Gender and Education Level",
       x = "Age",
       y = "Count")


accel = read_csv("nhanes_accel.csv") |>
  janitor::clean_names()
accel
covar_accel = merge(covar, accel, by = "seqn", all =TRUE) |>
  drop_na(sex, age)
covar_accel
```



```{R}
#Q3 citibike
jan20 = read_csv("Jan2020Citi.csv") |>
  janitor::clean_names() |>
  mutate(time = "Jan2020")
jan24 = read_csv("Jan2024Citi.csv") |>
  janitor::clean_names() |>
  mutate(time = "Jan2024")
jul20 = read_csv("July2020Citi.csv") |>
  janitor::clean_names() |>
  mutate(time = "Jul2020")
jul24 = read_csv("July2024Citi.csv") |>
  janitor::clean_names() |>
  mutate(time = "Jul2024")
names(jul24)
names(jan24)
df_list <- list(jan20, jul20, jan24, jul24)
merged_df <- df_list %>% 
  reduce(full_join, by = names(jan20))
merged_df
table1 = merged_df |>
  group_by(time, member_casual) |>
  summarize(total = n())
table1
```


```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
